digraph {
  nodesep=0.5

  {
    node [
      shape=component
    ]
    containerCore [
      label="Container Core"
    ]
    asyncPlatform [
      label="Async Platform"
    ]
  }

  start [
    label="Start"
    shape="circle"
    color="blue"
  ]
  
  end [
    label="End"
    shape="circle"
    color="blue"
  ]
  
  lookupUser [
    label="Lookup user"
    shape="rectangle"
  ]
  
  lookupJobs [
    label="Lookup jobs"
    shape="rectangle"
  ]
  
  isProjectIdFilter [
    label="Is project-id\nfilter enabled?"
    shape="diamond"
  ]
  
  projectIdFilter [
    label="Filter results\nby project ID"
    shape="rectangle"
  ]

  lookupStatus [
    label="Lookup result\njob statuses"
    shape="rectangle"
  ]

  oracle [
    label="User DB"
    shape="cylinder"
  ]

  start -> lookupUser

  lookupUser -> containerCore [
    dir="both"
    color="gray35"
    style="dashed"
  ]

  lookupUser -> lookupJobs

  lookupJobs -> oracle [
    dir="both"
    color="gray35"
    style="dashed"
  ]

  lookupJobs -> isProjectIdFilter

  isProjectIdFilter -> projectIdFilter [
    label="yes"
    ]
  
  isProjectIdFilter -> lookupStatus [
    label="no"
    ]

  projectIdFilter -> lookupStatus
  lookupStatus -> asyncPlatform [
    dir="both"
    color="gray35"
    style="dashed"
  ]

  lookupStatus -> end

  { rank=same; lookupUser; containerCore }
  { rank=same; lookupJobs; oracle }
  { rank=same; lookupStatus; asyncPlatform; projectIdFilter }
}